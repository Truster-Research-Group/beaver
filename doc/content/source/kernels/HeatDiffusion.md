# HeatDiffusion

!syntax description /Kernels/HeatDiffusion

## Description

The HeatDiffusion kernel borrows from the Tensor Mechanics module philosophy of spliting the differential operator, flux variable, and primal gradient variable into separate MOOSE objects linked by a 'base_name'. 
The first example, [Example 1](../../example/examples/ex01_kernel.md), in BEAVER shows how to manually connect the kernel and the two material objects in this sequence. 

!listing examples/ex01_kernel/ex01.i block=Kernels/diff1

The following describes the calculation of the thermal diffusion PDE. The strong-form of the thermal diffusion equation is defined on a 3-D domain $\Omega$ as: find $T$ such that

!equation id=strong-form
\begin{aligned}
-\nabla\cdot \mathbf{q}(T) &= 0 \in \Omega\\
T|_{\partial\Omega_1} &= g_1\\
\mathbf{q}(T) \cdot\ \hat{n} |_{\partial\Omega_2} &= g_2,
\end{aligned}

where $\partial\Omega_1$ is defined as the boundary on which the value of $T$ is fixed to a known
constant $g_1$, $\partial\Omega_2$ is defined as the boundary on which the flux across the boundary
is fixed to a known constant $g_2$, and $\hat{n}$ is the boundary outward normal.

The heat flux vector $\mathbf{q}(T)$ is defined with a material object such as [ComputeIsotropicHeat](../materials/ComputeIsotropicHeat.md) and linked with the parameter 'base_name', whose default value is the empty string.

The weak form is generated by multiplying by a test function ($\psi_i$) and integrating over the
domain (using inner-product notation):

!equation
(-\nabla\cdot\mathbf{q}(T_h), \psi_i) = 0\quad \forall\,\psi_i

and then integrating by parts which gives the weak form:

!equation id=weak-form
(\mathbf{q}(T_h), \nabla \psi_i) - \langle g_2, \psi_i\rangle = 0\quad \forall\,\psi_i,

where $T_h$ is known as the trial function that defines the finite element discretization, $T
\approx T_h = \sum_{j=1}^N T_j \phi_j$, with $\phi_j$ being the basis functions.

!syntax parameters /Kernels/HeatDiffusion

!syntax inputs /Kernels/HeatDiffusion

!syntax children /Kernels/HeatDiffusion
